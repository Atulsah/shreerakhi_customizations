[
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Stock Entry",
  "enabled": 1,
  "modified": "2025-09-02 18:33:02.787957",
  "module": "Shree",
  "name": "Custom Stock Entry",
  "script": "frappe.ui.form.on('Stock Entry', {\r\n    refresh: function(frm) {\r\n        frm.doc.items.forEach(row => {\r\n            let workstation = frm.doc.custom_factory__location || \"\";\r\n            let bill_no = frm.doc.custom_bill_no || \"\";\r\n            let combined_value = workstation && bill_no\r\n                ? (workstation + \"-\" + bill_no)\r\n                : (workstation || bill_no);\r\n\r\n            frappe.model.set_value(row.doctype, row.name, 'custom_factory_bill_no', combined_value);\r\n        });\r\n    }\r\n});\r\n\r\n",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Sales Invoice",
  "enabled": 1,
  "modified": "2025-10-14 16:54:42.784569",
  "module": "Shree",
  "name": "Custom Sales Invoice",
  "script": "frappe.ui.form.on(\"Sales Invoice\", {\r\n    refresh: function(frm) {\r\n        frm.fields_dict['custom_bos_transporter'].get_query = function(doc) {\r\n            return {\r\n                filters: {\r\n                    is_transporter: 1\r\n                }\r\n            };\r\n        };\r\n    }\r\n});\r\n\r\nfrappe.ui.form.on('Sales Invoice Item', {\r\n    item_code: function(frm, cdt, cdn) {\r\n        check_duplicate_item(frm, cdt, cdn);\r\n    },\r\n\r\n    items_add: function(frm, cdt, cdn) {\r\n        check_duplicate_item(frm, cdt, cdn);\r\n    }\r\n});\r\n\r\n// ---------- Helper Function ----------\r\nfunction check_duplicate_item(frm, cdt, cdn) {\r\n    let row = locals[cdt][cdn];\r\n    if (!row.item_code) return;\r\n\r\n    let duplicates = frm.doc.items\r\n        .map((item, index) => ({ item_code: item.item_code, row: index + 1 }))\r\n        .filter(item => item.item_code === row.item_code);\r\n\r\n    if (duplicates.length > 1) {\r\n        // Find the first occurrence row number\r\n        let first_row = duplicates[0].row;\r\n        frappe.msgprint({\r\n            title: __(\"Duplicate Item Found\"),\r\n            message: __(\"Item <b>{0}</b> has already been added earlier (Row {1}).\", [row.item_code, first_row]),\r\n            indicator: \"red\"\r\n        });\r\n\r\n        frappe.model.clear_doc(cdt, cdn);\r\n        frm.refresh_field('items');\r\n    }\r\n}\r\n",
  "view": "Form"
 }
]